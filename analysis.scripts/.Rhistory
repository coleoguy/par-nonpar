agg <- data %>%
group_by(r,s,h,model,chromosome) %>%
summarise_at(vars(Freq), list(Freq_median = ~median(., na.rm=TRUE)))
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_jitter(data = data, aes(colour=chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1,width = 0.01) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position="identity", size=3) +
facet_grid(model ~ h, scales="free_y") + theme_bw() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Freq_median")
p1
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_jitter(data = data, aes(colour=chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1,width = 0.01) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position="identity", size=3) +
facet_grid(model + r  ~ h, scales="free_y") + theme_bw() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Freq_median")
p1
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_jitter(data = data, aes(colour=chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1,width = 0.01) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position="identity", size=3) +
facet_grid(r + model ~ h, scales="free_y") + theme_bw() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Freq_median")
p1
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_jitter(data = data, aes(colour=chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1,width = 0.01) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position="dodge", size=3) +
facet_grid(r + model ~ h, scales="free_y") + theme_bw() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Freq_median")
p1
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_jitter(data = data, aes(colour=chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1,width = 0.01) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position_dodge(width=0.3), size=3) +
facet_grid(r + model ~ h, scales="free_y") + theme_bw() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Freq_median")
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_jitter(data = data, aes(colour=chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1,width = 0.01) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.3), size=3) +
facet_grid(r + model ~ h, scales="free_y") + theme_bw() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Freq_median")
p1
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_jitter(data = data, aes(colour=chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1,width = 0.01) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.05), size=3) +
facet_grid(r + model ~ h, scales="free_y") + theme_bw() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Freq_median")
p1
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_jitter(data = data, aes(colour=chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1,width = 0.01) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.1), size=3) +
facet_grid(r + model ~ h, scales="free_y") + theme_bw() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Freq_median")
p1
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_jitter(data = data, aes(colour=chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1,width = 0.01, position=position_dodge(width = 0.1)) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.1), size=3) +
facet_grid(r + model ~ h, scales="free_y") + theme_bw() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Freq_median")
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_jitter(data = data, aes(colour=chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1,width = 0.01, position=position_jitterdodge(width = 0.1)) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.1), size=3) +
facet_grid(r + model ~ h, scales="free_y") + theme_bw() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Freq_median")
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_jitter(data = data, aes(colour=chromosome, fill = chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1,width = 0.01, position=position_jitterdodge(width = 0.1)) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.1), size=3) +
facet_grid(r + model ~ h, scales="free_y") + theme_bw() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Freq_median")
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_jitter(data = data, aes(colour=chromosome, fill = chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1, position=position_jitterdodge(width = 0.1)) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.1), size=3) +
facet_grid(r + model ~ h, scales="free_y") + theme_bw() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Freq_median")
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_jitter(data = data, aes(colour=chromosome, fill = chromosome y = Freq, x = s), stat="identity", alpha=0.05, size=0.1,width = 0.01) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.1), size=3) +
facet_grid(r + model ~ h, scales="free_y") + theme_bw() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Freq_median")
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_jitter(data = data, aes(colour=chromosome, fill = chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1,width = 0.01) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.1), size=3) +
facet_grid(r + model ~ h, scales="free_y") + theme_bw() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Freq_median")
p1
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_point(data = data, aes(colour=chromosome, fill = chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1, position=position_jitterdodge(dodge.width=0.1)) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.1), size=3) +
facet_grid(r + model ~ h, scales="free_y") + theme_bw() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Freq_median")
p1
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_point(data = data, aes(colour=chromosome, fill = chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1, position=position_jitterdodge(dodge.width=0.11)) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.11), size=3) +
facet_grid(r + model ~ h, scales="free_y") + theme_bw() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Freq_median")
p1
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_point(data = data, aes(colour=chromosome, fill = chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1, position=position_jitterdodge(dodge.width=0.1)) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.1), size=3) +
facet_grid(r + model ~ h, scales="free_y") + theme_bw() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Freq_median")
p1
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_point(data = data, aes(colour=chromosome, fill = chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1, position=position_jitterdodge(dodge.width=0.1)) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.1), size=3) +
facet_grid(r + model ~ h, scales="free_y") + theme_bw() + facet_wrap(chromosome) +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Freq_median")
agg <- data %>%
group_by(r,s,h,chromosome,model) %>%
summarise_at(vars(Freq), list(Freq_median = ~median(., na.rm=TRUE)))
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_point(data = data, aes(colour=chromosome, fill = chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1, position=position_jitterdodge(dodge.width=0.1)) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.1), size=3) +
facet_grid(r + model ~ h, scales="free_y") + theme_bw() + facet_wrap(chromosome) +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Freq_median")
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_point(data = data, aes(colour=chromosome, fill = chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1, position=position_jitterdodge(dodge.width=0.1)) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.1), size=3) +
facet_grid(r + model ~ h, scales="free_y") + theme_bw() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Freq_median")
p1
data4$model[data4$r == 0.1] <- "r1nonpar"
data4 <- data3
data4$model[data4$r == 0.1] <- "r1nonpar"
View(data4)
data4$model == "model = auto.and.nonparX"[data4$r == 0.1] <- "r1nonpar"
data4 <- data3
(data4$model == "model = auto.and.nonparX")[data4$r == 0.1] <- "r1nonpar"
data4$model[(data4$r == 0.1 & data4$model == "model = auto.and.nonparY")] <- "r1nonpar"
View(data4)
data4 <- data3
data4$model[(data4$r == 0.1 & (data4$model == "model = auto.and.nonparY"|data4$model == "model = auto.and.nonparX"))] <- "r1nonpar"
data4$model2[(data4$r == 0.1 & (data4$model == "model = auto.and.nonparY"|data4$model == "model = auto.and.nonparX"))] <- "r1nonpar"
data4 <- data3
data4$model2[(data4$r == 0.1 & (data4$model == "model = auto.and.nonparY"|data4$model == "model = auto.and.nonparX"))] <- "r1nonpar"
data4 <- data3
data4$group[(data4$r == 0.1 & (data4$model == "model = auto.and.nonparY"|data4$model == "model = auto.and.nonparX"))] <- "r1nonpar"
data4$group[(data4$r == 0.4 & (data4$model == "model = auto.and.nonparY"|data4$model == "model = auto.and.nonparX"))] <- "r4nonpar"
data4$group[(data4$r == 0.1 & data4$model == "model = auto.and.parX")] <- "r1par"
data4$group[(data4$r == 0.4 & data4$model == "model = auto.and.nonparX")] <- "r4par"
data4 <- data3
data4$group[(data4$r == 0.1 & (data4$model == "model = auto.and.nonparY"|data4$model == "model = auto.and.nonparX"))] <- "r1nonpar"
data4$group[(data4$r == 0.4 & (data4$model == "model = auto.and.nonparY"|data4$model == "model = auto.and.nonparX"))] <- "r4nonpar"
data4$group[(data4$r == 0.1 & data4$model == "model = auto.and.parX")] <- "r1par"
data4$group[(data4$r == 0.4 & data4$model == "model = auto.and.parX")] <- "r4par"
is.na(data4)
data4[complete.cases(data4), ]
t <- (is.na(data4) == TRUE)
View(t)
summary(t)
library(stringr)
library(ggraptR)
library(dplyr)
results <- read.csv("../results/results.csv")
results$h <- as.numeric(str_sub(results$h, start=5))
results$r <- as.numeric(str_sub(results$r, start=5))
results$s <- as.numeric(str_sub(results$s, start=5))
X <- data.frame(results[, c(1,3:6)])
Y <- data.frame(results[, 2:6])
colnames(X)[1] <- colnames(Y)[1] <- "Freq"
both <- rbind(X, Y)
both$chromosome <- rep(c("X","Y"), each = 360000)
R1 <- both[both$r == 0.1, ]
R2 <- both[both$r == 0.2, ]
R4 <- both[both$r == 0.4, ]
data0 <- both[both$r != 0.2, ]
data1 <- filter(data0, !(model == "model = auto.and.nonparY" & chromosome == "X"))
data2 <- filter(data1, !(model == "model = auto.and.nonparX" & chromosome == "Y"))
data3 <- filter(data2, !(model == "model = auto.and.parY"))
data4 <- data3
data4$group[(data4$r == 0.1 & (data4$model == "model = auto.and.nonparY"|data4$model == "model = auto.and.nonparX"))] <- "r1nonpar"
data4$group[(data4$r == 0.4 & (data4$model == "model = auto.and.nonparY"|data4$model == "model = auto.and.nonparX"))] <- "r4nonpar"
data4$group[(data4$r == 0.1 & data4$model == "model = auto.and.parX")] <- "r1par"
data4$group[(data4$r == 0.4 & data4$model == "model = auto.and.parX")] <- "r4par"
data <- data4
agg <- data %>%
group_by(r,s,h,model,chromosome) %>%
summarise_at(vars(Freq), list(Freq_median = ~median(., na.rm=TRUE)))
agg <- data %>%
group_by(r,s,h,group,chromosome) %>%
summarise_at(vars(Freq), list(Freq_median = ~median(., na.rm=TRUE)))
View(agg)
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_point(data = data, aes(colour=chromosome, fill = chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1, position=position_jitterdodge(dodge.width=0.1)) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.1), size=3) +
facet_grid(r + group ~ h, scales="free_y") + theme_bw() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Freq_median")
p1
h.labs <- c("Recessive female-benefit allele", "Additive female-benefit allele", "Dominant female-benefit allele")
model.labs <- c("Non-PAR fusion", "PAR fusion", "Non-PAR fusion", "PAR fusion")
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_point(data = data, aes(colour=chromosome, fill = chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1, position=position_jitterdodge(dodge.width=0.1)) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.1), size=3) +
facet_grid(r + group ~ h, scales="free_y", labeller = labeller(h = h.labs, group = model.labs)) + theme_bw() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Freq_median")
p1
h.labs <- as.labeller(c("Recessive female-benefit allele", "Additive female-benefit allele", "Dominant female-benefit allele"))
group.labs <- as.labeller(c("Non-PAR fusion", "PAR fusion", "Non-PAR fusion", "PAR fusion"))
h.labs <- as_labeller(c("Recessive female-benefit allele", "Additive female-benefit allele", "Dominant female-benefit allele"))
group.labs <- as_labeller(c("Non-PAR fusion", "PAR fusion", "Non-PAR fusion", "PAR fusion"))
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_point(data = data, aes(colour=chromosome, fill = chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1, position=position_jitterdodge(dodge.width=0.1)) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.1), size=3) +
facet_grid(r + group ~ h, scales="free_y", labeller = labeller(h = h.labs, group = group.labs)) + theme_bw() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Freq_median")
p1
h.labs <- c("Recessive female-benefit allele", "Additive female-benefit allele", "Dominant female-benefit allele")
names(h.labs) <- c("recessive", "additive", "dominant")
names(group.labs) <- c("npar","par","npar","par")
group.labs <- c("Non-PAR fusion", "PAR fusion", "Non-PAR fusion", "PAR fusion")
names(group.labs) <- c("npar","par","npar","par")
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_point(data = data, aes(colour=chromosome, fill = chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1, position=position_jitterdodge(dodge.width=0.1)) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.1), size=3) +
facet_grid(r + group ~ h, scales="free_y", labeller = labeller(h = h.labs, group = group.labs)) +
theme_bw() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Freq_median")
p1
h.labs <- c(0 = "Recessive female-benefit allele", "Additive female-benefit allele", "Dominant female-benefit allele")
h.labs <- c("0" = "Recessive female-benefit allele","0.5"= "Additive female-benefit allele","1"= "Dominant female-benefit allele")
h.labs
group.labs <- c("r1nonpar"="Non-PAR fusion","r1par"= "PAR fusion", "r4nonpar"= "Non-PAR fusion","r4par"= "PAR fusion")
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_point(data = data, aes(colour=chromosome, fill = chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1, position=position_jitterdodge(dodge.width=0.1)) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.1), size=3) +
facet_grid(r + group ~ h, scales="free_y", labeller = labeller(h = h.labs, group = group.labs)) +
theme_bw() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Freq_median")
p1
h.labs <- c("0" = "Recessive SA allele","0.5"= "Additive SA allele","1"= "Dominant SA allele")
r.labs <- c("0.1" = "r = 0.1","0.4"= "r = 0.4")
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_point(data = data, aes(colour=chromosome, fill = chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1, position=position_jitterdodge(dodge.width=0.1)) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.1), size=3) +
facet_grid(r + group ~ h, scales="free_y", labeller = labeller(h = h.labs, group = group.labs, r = r.labs)) +
theme_bw() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Freq_median")
p1
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_point(data = data, aes(colour=chromosome, fill = chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1, position=position_jitterdodge(dodge.width=0.1)) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.1), size=3) +
facet_grid(r + group ~ h, scales="free_y", labeller = labeller(h = h.labs, group = group.labs, r = r.labs)) +
theme_bw() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("S") + ylab("Fused chromosome frequency")
p1
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_point(data = data, aes(colour=chromosome, fill = chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1, position=position_jitterdodge(dodge.width=0.1)) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.1), size=3) +
facet_grid(r + group ~ h, scales="free_y", labeller = labeller(h = h.labs, group = group.labs, r = r.labs)) +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Fused chromosome frequency")
p1
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_point(data = data, aes(colour=chromosome, fill = chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1, position=position_jitterdodge(dodge.width=0.1)) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.1), size=3) +
facet_grid(r + group ~ h, scales="free_y", labeller = labeller(h = h.labs, group = group.labs, r = r.labs)) +
theme_bw() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Fused chromosome frequency")
p1
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_point(data = data, aes(colour=chromosome, fill = chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1, position=position_jitterdodge(dodge.width=0.1)) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.1), size=3) +
facet_grid(r + group ~ h, scales="free_y", labeller = labeller(h = h.labs, group = group.labs, r = r.labs)) +
theme_light() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Fused chromosome frequency")
p1
ggsave(plot = p1, "figure1.png", width = 10, height = 7, type = "cairo-png")
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_point(data = data, aes(colour=chromosome, fill = chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1, position=position_jitterdodge(jitter.width = 0.3, dodge.width=0.1)) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.1), size=3) +
facet_grid(r + group ~ h, scales="free_y", labeller = labeller(h = h.labs, group = group.labs, r = r.labs)) +
theme_light() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Fused chromosome frequency")
p1
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_point(data = data, aes(colour=chromosome, fill = chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1, position=position_jitterdodge(jitter.width = 0.01, dodge.width=0.1)) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.1), size=3) +
facet_grid(r + group ~ h, scales="free_y", labeller = labeller(h = h.labs, group = group.labs, r = r.labs)) +
theme_light() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Fused chromosome frequency")
p1
# TODO
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_point(data = data, aes(colour=chromosome, fill = chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1, position=position_jitterdodge(jitter.width = 0.03, dodge.width=0.1)) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.1), size=3) +
facet_grid(r + group ~ h, scales="free_y", labeller = labeller(h = h.labs, group = group.labs, r = r.labs)) +
theme_light() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Fused chromosome frequency")
p1
ggsave(plot = p1, "figure1.png", width = 10, height = 7, type = "cairo-png")
# dotted line plot
p2 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_point(data = data, aes(colour=chromosome, fill = chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1, position=position_jitterdodge(jitter.width = 0.03, dodge.width=0.1)) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.1), size=3) +
geom_line(aes(colour=chromosome, fill=chromosome),stat="identity") +
facet_grid(r + group ~ h, scales="free_y", labeller = labeller(h = h.labs, group = group.labs, r = r.labs)) +
theme_light() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Fused chromosome frequency")
# dotted line plot
p2 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_point(data = data, aes(colour=chromosome, fill = chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1, position=position_jitterdodge(jitter.width = 0.03, dodge.width=0.1)) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.1), size=3) +
geom_line(aes(colour=chromosome),stat="identity") +
facet_grid(r + group ~ h, scales="free_y", labeller = labeller(h = h.labs, group = group.labs, r = r.labs)) +
theme_light() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Fused chromosome frequency")
p2
# dotted line plot
p2 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_point(data = data, aes(colour=chromosome, fill = chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1, position=position_jitterdodge(jitter.width = 0.03, dodge.width=0.1)) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.1), size=2) +
geom_line(aes(colour=chromosome),stat="identity") +
facet_grid(r + group ~ h, scales="free_y", labeller = labeller(h = h.labs, group = group.labs, r = r.labs)) +
theme_light() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Fused chromosome frequency")
p2
ggsave(plot = p2, "figure1.2.png", width = 10, height = 7, type = "cairo-png")
library(stringr)
library(ggraptR)
library(dplyr)
results <- read.csv("../results/results.csv")
results$h <- as.numeric(str_sub(results$h, start=5))
results$r <- as.numeric(str_sub(results$r, start=5))
results$s <- as.numeric(str_sub(results$s, start=5))
X <- data.frame(results[, c(1,3:6)])
Y <- data.frame(results[, 2:6])
colnames(X)[1] <- colnames(Y)[1] <- "Freq"
both <- rbind(X, Y)
both$chromosome <- rep(c("X","Y"), each = 360000)
R1 <- both[both$r == 0.1, ]
R2 <- both[both$r == 0.2, ]
R4 <- both[both$r == 0.4, ]
data0 <- both[both$r != 0.2, ]
data1 <- filter(data0, !(model == "model = auto.and.nonparY" & chromosome == "X"))
data2 <- filter(data1, !(model == "model = auto.and.nonparX" & chromosome == "Y"))
data3 <- filter(data2, !(model == "model = auto.and.parY"))
data4 <- data3
data4$group[(data4$r == 0.1 & (data4$model == "model = auto.and.nonparY"|data4$model == "model = auto.and.nonparX"))] <- "r1nonpar"
data4$group[(data4$r == 0.4 & (data4$model == "model = auto.and.nonparY"|data4$model == "model = auto.and.nonparX"))] <- "r4nonpar"
data4$group[(data4$r == 0.1 & data4$model == "model = auto.and.parX")] <- "r1par"
data4$group[(data4$r == 0.4 & data4$model == "model = auto.and.parX")] <- "r4par"
data <- data4
agg <- data %>%
group_by(r,s,h,group,chromosome) %>%
summarise_at(vars(Freq), list(Freq_median = ~median(., na.rm=TRUE)))
aggR1 <- R1 %>%
group_by(s,h,model,chromosome) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE), Freq_median = ~median(., na.rm=TRUE)))
aggR2 <- R2 %>%
group_by(s,h,model,chromosome) %>%
summarise_at(vars(Freq), list(Freq_median = ~median(., na.rm=TRUE)))
aggR4 <- R4 %>%
group_by(s,h,model,chromosome) %>%
summarise_at(vars(Freq), list(Freq_median = ~median(., na.rm=TRUE))) %>%
ungroup()
h.labs <- c("0" = "Recessive SA allele","0.5"= "Additive SA allele","1"= "Dominant SA allele")
group.labs <- c("r1nonpar"="Non-PAR fusion","r1par"= "PAR fusion", "r4nonpar"= "Non-PAR fusion","r4par"= "PAR fusion")
r.labs <- c("0.1" = "r = 0.1","0.4"= "r = 0.4")
# dotted line plot
p2 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_point(data = data, aes(colour=chromosome, fill = chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1, position=position_jitterdodge(jitter.width = 0.03, dodge.width=0.1)) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity", position=position_dodge(width = 0.1), size=2) +
geom_line(aes(colour=chromosome),stat="identity") +
facet_grid(r + group ~ h, scales="free_y", labeller = labeller(h = h.labs, group = group.labs, r = r.labs)) +
theme_light() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Fused chromosome frequency")
p2
ggsave(plot = p2, "figure1.2.png", width = 10, height = 7, type = "cairo-png")
setwd("~/par-nonpar/analysis.scripts")
library(doSNOW)
source("functions.R")
# Initial Population
pop.size <- 1000
# Probability of an individual having a mutation
mut.prob <- 1/1000
# Generations with columns being gamete types
generations <- 3
# Set number of clusters
NumberClusters <- 4
cl <- makeCluster(NumberClusters, outfile = "")
registerDoSNOW(cl)
iter <- 5
iter.results <- list()
parsed <- as.data.frame(matrix(NA, 1, 6))
colnames(parsed) <- c("frqX","frqY","model","h","r","s")
counter <- 1
# Type of fusions to introduce
# Possible models: (auto.and.) allXY, allX, allY, nonparX, parX, nonparY, parY
models <- c("auto.and.nonparX", "auto.and.parX", "auto.and.nonparY", "auto.and.parY")
for(o in 1:length(models)){
model <- models[o]
# Dominance factor of the female benefit allele (allele 1)
# 1 = dominant, 0.5 = additive, 0 = recessive
hs <- c(0,0.5,1)
for(n in 1:length(hs)){
h <- hs[n]
# Recombination distance between SAL locus and
# the point that is fused to the sex chromosome
rs <- c(0.1, 0.2, 0.4)
for(m in 1:length(rs)){
r <- rs[m]
# Selection coefficient for SAL
ss <- seq(from = 0.1, to = 1, length = 10)
for(k in 1:length(ss)){
s <- ss[k]
# This sets up results with each row being an iteration
results <- as.data.frame(matrix(NA, 1, 18))
colnames(results) <- c("XE0N","XE0P","XE0U","XE1N","XE1P","XE1U","XS0N","XS0P","XS0U",
"XS1N","XS1P","XS1U","YS0N","YS0P","YS0U","YS1N","YS1P","YS1U")
iter.results <- foreach(j = 1:iter,  .verbose = T) %dopar% {
pop.gam <- getInitialPop(pop.size = pop.size)
# Number of mutant individuals in a given generation
num.mutes <- rpois(n=generations, lambda = mut.prob * pop.size)
for(i in 1:generations){
# Get Juveniles based on initial gamete pool
pop.juv <- getJuveniles(pop.gam, pop.size)
# Get population fitnesses
pop.fits <- popFit(pop.juv, s = s, h = h)
# Viability Selection
pop.adu <- perfSeln(pop.juv, pop.fits)
# Recombination
pop.recom <- perfGameto(pop.adu, r = r)
# Gametogenesis
pop.gam <- StochRound(pop.recom)
# Mutations
pop.gam <- perfMutation(pop.gam, num.mutes, model)
return(pop.gam)
}
results[j, ] <- iter.results[[j]]
frqX <- sum(results[j, c(1,2,4,5,7,8,10,11)]) / sum(results[j, 1:12])
frqY <- sum(results[j, c(13,14,16,17)]) / sum(results[j, 13:18])
parsed[counter, (1:6)] <- c(frqX, frqY, model, h, r, s)
counter <- counter + 1
print(counter)
}
}
}
}
}
stopCluster(cl)
X <- data.frame(parsed[, c(1,3:6)])
Y <- data.frame(parsed[, 2:6])
colnames(X)[1] <- colnames(Y)[1] <- "Freq"
both <- rbind(X, Y)
both$chromosome <- rep(c("X","Y"), each = nrow(X))
long.results <- both
View(parsed)
