write.csv(ordered, file = "ordered.csv")
X <- data.frame(ordered[, c(1,3:6)])
X$chromosome <- "X"
Y <- data.frame(ordered[, 2:6])
Y$chromosome <- "Y"
colnames(X)[1] <- colnames(Y)[1] <- "Freq"
both <- rbind(X, Y)
save(both, file = "both.RData")
write.csv(both, file = "both.csv")
load("~/par-nonpar/results/both.RData")
data0 <- both[both$r != 0.2, ]
data1 <- filter(data0, !(model == "auto.and.nonparY" & chromosome == "X"))
data2 <- filter(data1, !(model == "auto.and.nonparX" & chromosome == "Y"))
data3 <- filter(data2, !(model == "auto.and.parY"))
data4 <- data3
data4$group[(data4$r == 0.1 & (data4$model == "auto.and.nonparY"|data4$model == "auto.and.nonparX"))] <- "r1nonpar"
data4$group[(data4$r == 0.4 & (data4$model == "auto.and.nonparY"|data4$model == "auto.and.nonparX"))] <- "r4nonpar"
data4$group[(data4$r == 0.1 & data4$model == "auto.and.parX")] <- "r1par"
data4$group[(data4$r == 0.4 & data4$model == "auto.and.parX")] <- "r4par"
data <- data4
agg <- data %>%
group_by(r,s,h,group,chromosome) %>%
summarise_at(vars(Freq), list(Freq_median = ~median(., na.rm=TRUE)))
aggR1 <- R1 %>%
group_by(s,h,model,chromosome) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE), Freq_median = ~median(., na.rm=TRUE)))
aggR2 <- R2 %>%
group_by(s,h,model,chromosome) %>%
summarise_at(vars(Freq), list(Freq_median = ~median(., na.rm=TRUE)))
aggR4 <- R4 %>%
group_by(s,h,model,chromosome) %>%
summarise_at(vars(Freq), list(Freq_median = ~median(., na.rm=TRUE))) %>%
ungroup()
h.labs <- c("0" = "Recessive SA allele","0.5"= "Additive SA allele","1"= "Dominant SA allele")
group.labs <- c("r1nonpar"="Non-PAR fusion","r1par"= "PAR fusion", "r4nonpar"= "Non-PAR fusion","r4par"= "PAR fusion")
r.labs <- c("0.1" = "r = 0.1","0.4"= "r = 0.4")
# Dotted line plot
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_point(data = data, aes(colour=chromosome, fill = chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1, position=position_jitterdodge(jitter.width = 0.03, dodge.width=0.1)) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity",position=position_dodge(width = 0.1),  size=2) +
geom_line(aes(colour=chromosome),stat="identity",position=position_dodge(width = 0.1), ) +
facet_grid(r + group ~ h, scales="free_y", labeller = labeller(h = h.labs, group = group.labs, r = r.labs)) +
theme_light() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Fused chromosome frequency")
p1
load("~/par-nonpar/results/both.RData")
# both <- rbind(X, Y)
# both$chromosome <- rep(c("X","Y"), each = 360000)
#
# # library(ggraptR)
# # ggraptR(both)
#
# R1 <- both[both$r == 0.1, ]
# R2 <- both[both$r == 0.2, ]
# R4 <- both[both$r == 0.4, ]
#########
load("~/par-nonpar/results/both.RData")
setwd("~/par-nonpar/figures")
ggsave(plot = p1, "figure1.png", width = 10, height = 7, type = "cairo-png")
ggsave(plot = p1, "figure1.pdf", width = 10, height = 7)
setwd("~/par-nonpar/figures")
library(stringr)
library(ggplot2)
library(dplyr)
load("~/par-nonpar/results/both.RData")
library(stringr)
library(ggplot2)
library(dplyr)
load("~/par-nonpar/results/both.RData")
View(both)
agg <- both %>%
group_by(r,s,h,group,chromosome) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg <- both %>%
group_by(r,s,h,chromosome) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
View(agg)
agg <- both %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
View(agg)
agg1 <- both %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
View(agg1)
mean0 <- agg1$Freq_mean[1]
data <- filter(both, !(s == 0))
MDE <- data$Freq - mean0
MDE <- data
MDE$Freq <- (MDE$Freq - mean0)
View(MDE)
data0 <- MDE[MDE$r != 0.2, ]
data1 <- filter(data0, !(model == "auto.and.nonparY" & chromosome == "X"))
data2 <- filter(data1, !(model == "auto.and.nonparX" & chromosome == "Y"))
data3 <- filter(data2, !(model == "auto.and.parY"))
data4 <- data3
data4$group[(data4$r == 0.1 & (data4$model == "auto.and.nonparY"|data4$model == "auto.and.nonparX"))] <- "r1nonpar"
data4$group[(data4$r == 0.4 & (data4$model == "auto.and.nonparY"|data4$model == "auto.and.nonparX"))] <- "r4nonpar"
data4$group[(data4$r == 0.1 & data4$model == "auto.and.parX")] <- "r1par"
data4$group[(data4$r == 0.4 & data4$model == "auto.and.parX")] <- "r4par"
data <- data4
agg <- data %>%
group_by(r,s,h,group,chromosome) %>%
summarise_at(vars(Freq), list(Freq_median = ~median(., na.rm=TRUE)))
aggR1 <- R1 %>%
group_by(s,h,model,chromosome) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE), Freq_median = ~median(., na.rm=TRUE)))
aggR2 <- R2 %>%
group_by(s,h,model,chromosome) %>%
summarise_at(vars(Freq), list(Freq_median = ~median(., na.rm=TRUE)))
aggR4 <- R4 %>%
group_by(s,h,model,chromosome) %>%
summarise_at(vars(Freq), list(Freq_median = ~median(., na.rm=TRUE))) %>%
ungroup()
MDE <- data
MDE$Freq <- (MDE$Freq - mean0)
data0 <- MDE[MDE$r != 0.2, ]
R1 <- MDE[MDE$r == 0.1, ]
R2 <- MDE[MDE$r == 0.2, ]
R4 <- MDE[MDE$r == 0.4, ]
data1 <- filter(data0, !(model == "auto.and.nonparY" & chromosome == "X"))
data2 <- filter(data1, !(model == "auto.and.nonparX" & chromosome == "Y"))
data3 <- filter(data2, !(model == "auto.and.parY"))
data4 <- data3
data4$group[(data4$r == 0.1 & (data4$model == "auto.and.nonparY"|data4$model == "auto.and.nonparX"))] <- "r1nonpar"
data4$group[(data4$r == 0.4 & (data4$model == "auto.and.nonparY"|data4$model == "auto.and.nonparX"))] <- "r4nonpar"
data4$group[(data4$r == 0.1 & data4$model == "auto.and.parX")] <- "r1par"
data4$group[(data4$r == 0.4 & data4$model == "auto.and.parX")] <- "r4par"
data <- data4
library(stringr)
library(ggplot2)
library(dplyr)
load("~/par-nonpar/results/both.RData")
agg1 <- both %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
mean0 <- agg1$Freq_mean[1]
data <- filter(both, !(s == 0))
MDE <- data
MDE$Freq <- (MDE$Freq - mean0)
data0 <- MDE[MDE$r != 0.2, ]
R1 <- MDE[MDE$r == 0.1, ]
R2 <- MDE[MDE$r == 0.2, ]
R4 <- MDE[MDE$r == 0.4, ]
data1 <- filter(data0, !(model == "auto.and.nonparY" & chromosome == "X"))
data2 <- filter(data1, !(model == "auto.and.nonparX" & chromosome == "Y"))
data3 <- filter(data2, !(model == "auto.and.parY"))
data4 <- data3
data4$group[(data4$r == 0.1 & (data4$model == "auto.and.nonparY"|data4$model == "auto.and.nonparX"))] <- "r1nonpar"
data4$group[(data4$r == 0.4 & (data4$model == "auto.and.nonparY"|data4$model == "auto.and.nonparX"))] <- "r4nonpar"
data4$group[(data4$r == 0.1 & data4$model == "auto.and.parX")] <- "r1par"
data4$group[(data4$r == 0.4 & data4$model == "auto.and.parX")] <- "r4par"
data <- data4
agg <- data %>%
group_by(r,s,h,group,chromosome) %>%
summarise_at(vars(Freq), list(Freq_median = ~median(., na.rm=TRUE)))
aggR1 <- R1 %>%
group_by(s,h,model,chromosome) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE), Freq_median = ~median(., na.rm=TRUE)))
aggR2 <- R2 %>%
group_by(s,h,model,chromosome) %>%
summarise_at(vars(Freq), list(Freq_median = ~median(., na.rm=TRUE)))
aggR4 <- R4 %>%
group_by(s,h,model,chromosome) %>%
summarise_at(vars(Freq), list(Freq_median = ~median(., na.rm=TRUE))) %>%
ungroup()
h.labs <- c("0" = "Recessive SA allele","0.5"= "Additive SA allele","1"= "Dominant SA allele")
group.labs <- c("r1nonpar"="Non-PAR fusion","r1par"= "PAR fusion", "r4nonpar"= "Non-PAR fusion","r4par"= "PAR fusion")
r.labs <- c("0.1" = "r = 0.1","0.4"= "r = 0.4")
# Dotted line plot
p1 <- ggplot(agg, aes(y=Freq_median, x=s)) +
geom_point(data = data, aes(colour=chromosome, fill = chromosome, y = Freq, x = s), stat="identity", alpha=0.05, size=0.1, position=position_jitterdodge(jitter.width = 0.03, dodge.width=0.1)) +
geom_point(aes(colour=chromosome, fill=chromosome), shape = 21,colour = "black", alpha = 0.5, stat="identity",position=position_dodge(width = 0.1),  size=2) +
geom_line(aes(colour=chromosome),stat="identity",position=position_dodge(width = 0.1), ) +
facet_grid(r + group ~ h, scales="free_y", labeller = labeller(h = h.labs, group = group.labs, r = r.labs)) +
theme_light() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
scale_size(range=c(1, 3)) + xlab("s") + ylab("Fused chromosome frequency")
p1
MDE1 <- filter(MDE, !(h == 0))
MDE1 <- filter(MDE1, !(h == 1))
View(MDE1)
MDE <- data
MDE$Freq <- (MDE$Freq - mean0)
MDE <- filter(MDE, !(h == 0))
MDE <- filter(MDE, !(h == 1))
MDE
library(stringr)
library(ggplot2)
library(dplyr)
load("~/par-nonpar/results/both.RData")
agg1 <- both %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
mean0 <- agg1$Freq_mean[1]
data <- filter(both, !(s == 0))
MDE <- data
MDE$Freq <- (MDE$Freq - mean0)
MDE <- filter(MDE, !(h == 0))
MDE <- filter(MDE, !(h == 1))
MDE1 <- filter(MDE, (r == 0.1 & (model == "auto.and.nonparX" | model == "auto.and.nonparY")))
View(MDE1)
MDE2 <- filter(MDE, (r == 0.4 & (model == "auto.and.nonparX" | model == "auto.and.nonparY")))
MDE3 <- filter(MDE, (r == 0.1 & (model == "auto.and.parX" | model == "auto.and.parY")))
MDE4 <- filter(MDE, (r == 0.4 & (model == "auto.and.parX" | model == "auto.and.parY")))
mean1 <- mean(MDE1$Freq)
mean2 <- mean(MDE2$Freq)
mean3 <- mean(MDE3$Freq)
mean4 <- mean(MDE4$Freq)
agg1 <- MDE1 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg2 <- MDE1 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
View(agg2)
agg1 <- MDE1 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg2 <- MDE2 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg3 <- MDE3 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg4 <- MDE4 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
p1 <- ggplot(agg1, aes(s, Freq_mean)) +
geom_line()
p1
p1 <- ggplot(agg1, aes(s, Freq_mean)) +
geom_line() +
geom_line(agg2, aes(s, Freq_mean)) +
geom_line(agg3, aes(s, Freq_mean)) +
geom_line(agg4, aes(s, Freq_mean)) +
p1
View(agg3)
p1 <- ggplot() +
geom_line(agg1, aes(s, Freq_mean)) +
geom_line(agg2, aes(s, Freq_mean)) +
geom_line(agg3, aes(s, Freq_mean)) +
geom_line(agg4, aes(s, Freq_mean)) +
p1
p1 <- ggplot() +
geom_line(agg1, aes(s, Freq_mean)) +
geom_line(agg2, aes(s, Freq_mean)) +
geom_line(agg3, aes(s, Freq_mean)) +
geom_line(agg4, aes(s, Freq_mean)) +
p1
p1 <- ggplot() +
geom_line(agg1, aes(s, Freq_mean)) +
geom_line(agg2, aes(s, Freq_mean)) +
geom_line(agg3, aes(s, Freq_mean)) +
geom_line(agg4, aes(s, Freq_mean))
p1
p1 <- ggplot(agg1, aes(s, Freq_mean)) +
geom_line() +
geom_line(agg2, aes(s, Freq_mean)) +
geom_line(agg3, aes(s, Freq_mean)) +
geom_line(agg4, aes(s, Freq_mean))
p1
agg1$group <- 1
View(agg1)
aggs <- rbind(agg1,agg2,agg3,agg4)
agg1 <- MDE1 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg1$group <- 1
agg2 <- MDE2 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg3$group <- 2
agg3 <- MDE3 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg3$group <- 3
agg4 <- MDE4 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg4$group <- 4
aggs <- rbind(agg1,agg2,agg3,agg4)
agg1 <- MDE1 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg1$group <- 1
agg2 <- MDE2 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg2$group <- 2
agg3 <- MDE3 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg3$group <- 3
agg4 <- MDE4 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg4$group <- 4
aggs <- rbind(agg1,agg2,agg3,agg4)
View(aggs)
p1 <- ggplot(aggs, aes(s, Freq_mean, col=group)) +
geom_line() +
p1
p1 <- ggplot(aggs, aes(s, Freq_mean, col=group)) +
geom_line()
p1
p1 <- ggplot(aggs, aes(s, Freq_mean, colour=group)) +
geom_line()
p1
p1 <- ggplot(aggs, aes(x=s, y=Freq_mean, color=group)) +
geom_line()
p1 <- ggplot(aggs, aes(x=s, y=Freq_mean, color=group, group = group)) +
geom_line()
p1
p1 <- ggplot(aggs, aes(x=s, y=Freq_mean, group = group)) +
geom_line()
p1
p1 <- ggplot(aggs, aes(x=s, y=Freq_mean, group = group, color=group)) +
geom_line()
p1
p1 <- ggplot(aggs, aes(x=s, y=Freq_mean, group = group, color=group)) +
scale_color_manual(values=c('Green','Yellow',"Red"))
geom_line()
p1 <- ggplot(aggs, aes(x=s, y=Freq_mean, group = group, color=group)) +
scale_color_manual(values=c('Green','Yellow',"Red")) +
geom_line()
p1
View(aggs)
agg1 <- MDE1 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg1$group <- A
agg2 <- MDE2 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg2$group <- B
agg3 <- MDE3 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg3$group <- C
agg4 <- MDE4 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg1 <- MDE1 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg1$group <- "A"
agg2 <- MDE2 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg2$group <- "B"
agg3 <- MDE3 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg3$group <- "C"
agg4 <- MDE4 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg4$group <- "D"
aggs <- rbind(agg1,agg2,agg3,agg4)
p1 <- ggplot(aggs, aes(x=s, y=Freq_mean, group = group, color=group)) +
scale_color_manual(values=c('Green','Yellow',"Red")) +
geom_line()
p1
p1 <- ggplot(aggs, aes(x=s, y=Freq_mean, group = group, color=group)) +
geom_line()
p1
agg1 <- MDE1 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg1$group <- "NonPAR r=0.1"
agg2 <- MDE2 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg2$group <- "NonPAR r=0.4"
agg3 <- MDE3 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg3$group <- "PAR r=0.1"
agg4 <- MDE4 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg4$group <- "PAR r=0.4"
aggs <- rbind(agg1,agg2,agg3,agg4)
p1 <- ggplot(aggs, aes(x=s, y=Freq_mean, group = group, color=group)) +
geom_line()
p1
ggsave(plot = p1, "figure2.png", width = 10, height = 7, type = "cairo-png")
ggsave(plot = p1, "figure2.pdf", width = 10, height = 7)
library(stringr)
library(ggplot2)
library(dplyr)
load("~/par-nonpar/results/both.RData")
agg <- both %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
mean0 <- agg1$Freq_mean[1]
data <- filter(both, !(s == 0))
MDE <- data
MDE$Freq <- (MDE$Freq - mean0)
MDE <- filter(MDE, !(h == 0))
MDE <- filter(MDE, !(h == 1))
MDE1 <- filter(MDE, (r == 0.1 & (model == "auto.and.nonparX" | model == "auto.and.nonparY")))
MDE2 <- filter(MDE, (r == 0.2 & (model == "auto.and.nonparX" | model == "auto.and.nonparY")))
MDE3 <- filter(MDE, (r == 0.4 & (model == "auto.and.nonparX" | model == "auto.and.nonparY")))
MDE4 <- filter(MDE, (r == 0.1 & (model == "auto.and.parX" | model == "auto.and.parY")))
MDE5 <- filter(MDE, (r == 0.2 & (model == "auto.and.parX" | model == "auto.and.parY")))
MDE6 <- filter(MDE, (r == 0.4 & (model == "auto.and.parX" | model == "auto.and.parY")))
agg1 <- MDE1 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg1$group <- "NonPAR r=0.1"
agg2 <- MDE2 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg2$group <- "NonPAR r=0.2"
agg3 <- MDE3 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg3$group <- "NonPAR r=0.4"
agg4 <- MDE4 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg4$group <- "PAR r=0.1"
agg5 <- MDE5 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg5$group <- "PAR r=0.2"
agg6 <- MDE6 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg6$group <- "PAR r=0.4"
aggs <- rbind(agg1,agg2,agg3,agg4)
p1 <- ggplot(aggs, aes(x=s, y=Freq_mean, group = group, color=group)) +
geom_line()
p1
ggsave(plot = p1, "figure2.png", width = 10, height = 7, type = "cairo-png")
ggsave(plot = p1, "figure2.pdf", width = 10, height = 7)
library(stringr)
library(ggplot2)
library(dplyr)
load("~/par-nonpar/results/both.RData")
agg <- both %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
mean0 <- agg$Freq_mean[1]
data <- filter(both, !(s == 0))
MDE <- data
MDE$Freq <- (MDE$Freq - mean0)
MDE <- filter(MDE, !(h == 0))
MDE <- filter(MDE, !(h == 1))
MDE1 <- filter(MDE, (r == 0.1 & (model == "auto.and.nonparX" | model == "auto.and.nonparY")))
MDE2 <- filter(MDE, (r == 0.2 & (model == "auto.and.nonparX" | model == "auto.and.nonparY")))
MDE3 <- filter(MDE, (r == 0.4 & (model == "auto.and.nonparX" | model == "auto.and.nonparY")))
MDE4 <- filter(MDE, (r == 0.1 & (model == "auto.and.parX" | model == "auto.and.parY")))
MDE5 <- filter(MDE, (r == 0.2 & (model == "auto.and.parX" | model == "auto.and.parY")))
MDE6 <- filter(MDE, (r == 0.4 & (model == "auto.and.parX" | model == "auto.and.parY")))
agg1 <- MDE1 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg1$group <- "NonPAR r=0.1"
agg2 <- MDE2 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg2$group <- "NonPAR r=0.2"
agg3 <- MDE3 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg3$group <- "NonPAR r=0.4"
agg4 <- MDE4 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg4$group <- "PAR r=0.1"
agg5 <- MDE5 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg5$group <- "PAR r=0.2"
agg6 <- MDE6 %>%
group_by(s) %>%
summarise_at(vars(Freq), list(Freq_mean = ~mean(., na.rm=TRUE)))
agg6$group <- "PAR r=0.4"
aggs <- rbind(agg1,agg2,agg3,agg4)
p1 <- ggplot(aggs, aes(x=s, y=Freq_mean, group = group, color=group)) +
geom_line()
p1
ggsave(plot = p1, "figure2.png", width = 10, height = 7, type = "cairo-png")
ggsave(plot = p1, "figure2.pdf", width = 10, height = 7)
aggs <- rbind(agg1,agg2,agg3,agg4,agg5,agg6)
p1 <- ggplot(aggs, aes(x=s, y=Freq_mean, group = group, color=group)) +
geom_line()
p1
ggsave(plot = p1, "figure2.png", width = 10, height = 7, type = "cairo-png")
ggsave(plot = p1, "figure2.pdf", width = 10, height = 7)
p1 <- ggplot(aggs, aes(x=s, y=Freq_mean, group = group, color=group)) +
geom_line() +
theme_light() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5))
p1
ggsave(plot = p1, "figure2.png", width = 10, height = 7, type = "cairo-png")
ggsave(plot = p1, "figure2.pdf", width = 10, height = 7)
p1 <- ggplot(aggs, aes(x=s, y=Freq_mean, group = group, color=group)) +
geom_line() +
geom_hline(yintercept=0)
theme_light() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5))
p1 <- ggplot(aggs, aes(x=s, y=Freq_mean, group = group, color=group)) +
geom_line() +
geom_hline(yintercept=0) +
theme_light() +
theme(text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5))
p1
